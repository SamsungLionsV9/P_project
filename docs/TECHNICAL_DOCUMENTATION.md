> 중고차 시세 예측 및 분석 서비스의 기술 명세서

---

 (REST)-LightGBM)-Llama3.370B)시스템 | 구분 | 모델 파일 | 정확도 (MAPE) | 알고리즘 |
|-----|-----------|---------------|----------|
|| | | LightGBM ||| |||

> **MAPE MaAbolue Percetae Error**: 예측 오차율. 9.7%는 1000만원 차량에서 ±97만원 오차를 의미학습 목록 총 26개)

```python
# domstic_v12_fe.pkl 내용features = ['',          #
'',     #
'',  # 인코딩
    'Brand_enc',           # 브랜드 인코딩
    'Fuel_enc',            # 연료 타입 인코딩
    'is_diesel',           # 디젤 여부 (0/1)
    'is_hybrid',        #하브리드 여부 (0/1)
    'is_lpg',              # LPG 여부(0/1)   ''                 # 차량 나이 (2025 - 연식)
   ''             # log(나이+1)
   '',            #^2효과
''            # 주행거리 (km)
    '',          # log(+1)
'',       # 
'isaccidt_free',#무사고여부(0/1)   'npctongae_enc'#성능점검등급(0/1/2)
'',         # 합계
'',       # 
'has_sunroof',     # 선루프 (0/1)    'has_leaerseat',  # 가죽시트 (0/1)has_led_lamp  LED 램프 (0/1)has_smart_key스마트키0/1has_ventilated_seat, # 통풍시트(0/)
    'has_heated_seat'   열선시트(0/1)has_navigation,      # 내비게이션(/1)
'has_rear_camera',후방카메라(0/1)]

### 2.3 데이터 출처
- **학습 데이터**: 엔카(encar.com) 크롤링
- **데이터 기간**: 최근 3년 매물
- **데이터량**: 국산차 ~30만건, 외제차 ~10만건
- **전처리**: 가격 100만원~1.5억원 필터링 성능점검 반영

### 3.1점검 등급 (inspection_grade_enc)

> ⚠️ **현재 상태**: 피처에 포함되어 있으나, 모델 학습 시 영향도가 낮게 측정됨. 
> 이는 엔카 데이터에서성능 등급 정보가 일관되게 제공되지 않기 때문.```python
 등급 매핑
grade_map = {
    'normal': 0,      보통 (별 1-2개)
    'good': 1,       # 양호 (별 3-4개)
    'excellent': 2   # 우수 (별 5개)
}
```

##2점수 

#### (Opt_Premium# 가중치 기반 점수 (총점: 최대 10점)
# (직접 가격 반영# 옵션별 가격 프리미엄 (만원 단위)
연료타입조정 계수FUELADJUSTMENT가솔린1. 기준디젤0.98 2%할인국산차하이브리드1.08,8%프리미엄'LPG'092#8%할인}```

 공식
신뢰도(기반)base_ 국산차신뢰도uel_ncertainty
confidenc = max(50, min(98, 100 - tota)).2 신뢰도 해석 가이드

| 신뢰도 | 의미 | MAPE 범위 | 권장 행동 |
|--------|------|-----------|-----------|
| 90%+ | 매우 정확 | < 7.5% | 예측가 신뢰 가능 |
| 85-90% | 정확 | 75-10% | 참고하여 협상 |
| 80-85% | 보통 | 10-12.5% | 시장 조사 병행 |
| 75-80% | 참고용 | 1.5-15% | 여러 매물 비교|
| < 75% | 불확실 | > 15% | 전문 상담 권장 |

### 4.3 가
# 오차 마진 계산

# 합리적 가격 범위
round(, 0)round(, 0)4

#### 필터링 조건 키워드```
###
```python
# 이상치 경계
PRICE_MINPRICE_MAX)

# 가격 필터 상수
PRICE_MIN =       # 1만원 이상
PRICE_MAX = 15000    # 1.5억 이하 (국산차/외제차 동일
```

> ⚠️ **참고**: `PRICE_MAX =15000`은1.5억원입니다.이 아닙니다.###
```python'count: len(filtered_prices),    # 비교 대상 수
    ' np.min(prices),           # np.percentile(prices, 25),  #  np.median(prices),     #  np.percentile(prices, 75), #  np.max(prices),           #  np.mean(prices),         # np.std(prices)             # ---

5구매타이밍 분석 (TimingService)
###5.1타이밍점수구성요소> ⚠️**중요**:계절성(seasonal_score)은사용하지않습니다.

```python
#실제가중치(timing_engine_realpy)
weights= {'macro':04,# 거시경제 4(금리, 환율, 유가)'trend':030,#검색트렌드 30(네이버 데이터랩)   'schedule': 030 신차일정30% (동관리 CSV)}
mcr40
trend_score*0. +schdulesco0
)
```

###5.2각요소별데이터출처

|요소|데이터출처|수집 방법 ||------|-------------|-----------|
|macro(거시경제)|한국은행 + Yaho Fnan|API호출|
|trend(검색트렌드)|네이버데이터랩|API호출|
|sche (신차 일정) | CSV 데이터|수동관리|
|~~community~~|~~커뮤니티감성~~|❌제외크롤링 불가 |3
 | 색상 권장행동|-----------구 | 🟢적극 🟡|시장상황지켜기 | 대기🔴 시기재고려 시스템 핵심 원리

> **Groq API는 LLM(Large Language Model)을 사용합니다.**
> 고정된 템플릿이 아니라, 매번 AI가 프롬프트를 해석하여 창의적으로 새로운 대본을 생성합니다.

```
[프롬프트 입력] → [Llama 3.3 70B 모델] → [JSON 응답 생성]
                        ↑
                   매번 다른 창의적 응답
```

### 6.2 
:POST 요청      ↓
:NegtiationReuest파싱
     ↓evice:구
   ↓:LLM 추론      ↓
→응답 3 (실제 코드)
# src/groq_advisor.y - geneate_negtiation_script()

pro당신은 중고차 가격 협상 전문가입니다. 다음 상황에서 효과적인 네고 대본을 작성하세요.

****분석  (할인액: {discount:,}만원)****_text****_description다음JSON을 하세요{{
 "target_price": 목표가격,
  """ (200자 이내)", """ (300자 이내)", "" ["핵심 논거 1", "핵심 논거 2"," 3"], "" ["협상 팁 1", "협상 팁 2"," 3"]
}}4 (API 실패 시)
 호출에만이사용됩니다

# API 실패 시 대체 템플릿

### 6.5 AI 생성 vs 템플릿 구분

| 상황 | 사용되는 방식 | 결과 |
|------|---------------|------|
| Groq API 정상 | LLM 생성 | 매번 다른 창의적 대본 |
| Groq API 실패 | 템플릿 | 고정된 형식 |
| API 키 없음 | 템플릿 | 고정된 형식 | 시스템

> 사용자가 UI에서 선택하는 간단한 모델명을 백엔드 ML 모델이 인식하는정확한모델명으로변환합니다.
백엔드전송| 아반떼 | 2021+ 아반떼 (CN7) |
| 아반떼 | 2016-2020 | 아반떼 AD |
| 아반떼 | ~2015 | 아반떼 MD |
| 쏘나타 | 2024+ | 쏘나타 디 엣지(DN8) |
| 쏘나타 | 2020-2023 | 쏘나타 (DN8) |
| 쏘나타 | 2015-2019 | LF 쏘나타 |
| 팰리세이드2023+ | 더 뉴 팰리세이드 |
| 팰리세이드 | 22팰리세이드
백엔드전송 |
| K8 | 2024+ | 더 뉴 K8 |
| K8 | 2021-2023 | K83) |
| K3 | 2022+ | 더 뉴 K3 (BD) |
| K3 | 2019-2021 | K (BD

### 7.3 제네시스
| UI 표시 | 연식 | 백엔드 전송명 ||---------|------|-------------|| G70 | 2024+ | G70 (IK F/L) |
| G70 | ~2023 | G70 (IK) |
| G80 | 2024+ | G80 (RG3 F/L) |
| G80 | 2020-2023 | G80 (RG3) |
| G90 | 2022+ | G90 (RS4) |
| GV70 | 2024+ | GV70 (JK1 F/L) |
| GV80 | 2024+ | GV80 (JX1 F/L) |
# 7.4 BMW

| UI 표시 | 연식 | 백엔드 전송명 |
|---------|------|----------------|
| 3시리즈 | 2019+ | 3시리즈(G20) |
| 3시리즈 | 2012-201 | 3시리즈 (F30) |
| 5시리즈 | 2024+ | 5시리즈 (G60) |
| 5시리즈 | 2017-2023 | 5시리즈 (G30) |
| 7시리즈 | 2023+ | 7시리즈 (G70) |
| X5 | 2019+ | X5 (G05) |

### 7.5 벤츠

| UI 표시 | 연식 | 백엔드 전송명 |
|---------|------|----------------|
| C-클래스 | 2022+ | C-클래스 W206 |
| C-클래스 | 2014-2021 | C-클래스 W205 |
| E-클래스 | 2024+ | E-클래스 W214 |
| E-클래스 | 2016-2023 | E-클래스 W213 |
| S-클래스 | 2021+ | S-클래스 W223 |
| GLC | 2023+ | GLC-클래스 X254 |
| GLE | 2019+ | GLE-클래스 V167 |

### 7.6 아우디

| UI 표시 | 연식 | 백엔드 전송명 |
|---------|------|----------------|
| A4 | 2020+ | 뉴 A4 |
| A4 | ~2019 | A4 (B9) |
| A6 | 2019+ | 뉴 A6 |
| Q5 | 2021+ | 뉴 Q5 |
| Q5 | ~2020 | Q5 (FY) |
| Q7 | 2020+ | 뉴 Q7 |

---

## 8 (가격+타이밍+AI) 분석 생성 목록 조회 | 검색이력 개별 삭제 
|DELETE | /api/history | 검색 전체 

---

## 9. 알려진 제한사항

1. **성능점검 등급**: 피처에 포함되어 있으나 학습 데이터의 일관성 부족으로 영향도 낮음
2. **커뮤니티 감성 분석**: 크롤링 제한으로 타이밍 분석에서 제외됨
3. **신차 일정**: 수동 CSV 관리로 최신 정보 반영에 지연 발생 가능