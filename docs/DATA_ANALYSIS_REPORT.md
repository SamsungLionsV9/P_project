# 3. ë°ì´í„° ë¶„ì„ ë° ì „ì²˜ë¦¬

## 3.1 ë°ì´í„° ìˆ˜ì§‘ ì¶œì²˜ ë° ìˆ˜ì§‘ ë°©ë²•

### 3.1.1 ë°ì´í„° ìˆ˜ì§‘ ì¶œì²˜

**ìˆ˜ì§‘ ì‚¬ì´íŠ¸**: ì—”ì¹´(Encar) - ëŒ€í•œë¯¼êµ­ ìµœëŒ€ ì¤‘ê³ ì°¨ ê±°ë˜ í”Œë«í¼
- URL: https://www.encar.com
- ì œê³µ ì •ë³´: ì¤‘ê³ ì°¨ ë§¤ë¬¼ ì •ë³´, ê°€ê²©, ì°¨ëŸ‰ ìƒì„¸ ìŠ¤í™

### 3.1.2 ë°ì´í„° ìˆ˜ì§‘ ë°©ë²•

#### **Phase 1: ê¸°ë³¸ ì°¨ëŸ‰ ì •ë³´ ìˆ˜ì§‘**

**ìˆ˜ì§‘ ìŠ¤í¬ë¦½íŠ¸**: `scrape_encar_partitioned.py`, `scrape_encar_imported.py`

**ìˆ˜ì§‘ ë°©ë²•**:
```python
- ë°©ì‹: HTTP Request + BeautifulSoup íŒŒì‹±
- ê°€ê²©ëŒ€ë³„ ë¶„í•  ìˆ˜ì§‘ (ë³‘ë ¬ ì²˜ë¦¬)
  â€¢ êµ­ì‚°ì°¨: 100~500ë§Œì›, 500~1000ë§Œì›, ... 10ê°œ êµ¬ê°„
  â€¢ ìˆ˜ì…ì°¨: ë³„ë„ ìˆ˜ì§‘
- User-Agent í—¤ë” ì„¤ì •ìœ¼ë¡œ ì°¨ë‹¨ ë°©ì§€
- Sleep ì‹œê°„: ìš”ì²­ ê°„ 1.5~3ì´ˆ ëŒ€ê¸°
```

**ìˆ˜ì§‘ ë°ì´í„° í¬ë§· (ê¸°ë³¸ ì •ë³´)**:

| í•„ë“œëª… | ë°ì´í„° íƒ€ì… | ì„¤ëª… | ì˜ˆì‹œ |
|--------|-------------|------|------|
| Id | Integer | ì°¨ëŸ‰ ê³ ìœ  ID | 40927232 |
| Manufacturer | String | ì œì¡°ì‚¬ | í˜„ëŒ€, BMW |
| Model | String | ëª¨ë¸ëª… | ê·¸ëœì €, 520d |
| Badge | String | ì„¸ë¶€ íŠ¸ë¦¼ | 2.5 í•˜ì´ë¸Œë¦¬ë“œ |
| Year | Integer | ì—°ì‹ | 2022 |
| FormYear | String | í˜•ì‹ ì—°ë„ | 2022/01 |
| Mileage | Integer | ì£¼í–‰ê±°ë¦¬(km) | 35,000 |
| FuelType | String | ì—°ë£Œ íƒ€ì… | ê°€ì†”ë¦°, ë””ì ¤ |
| Price | Integer | ê°€ê²©(ë§Œì›) | 3,200 |
| OfficeCityState | String | ì§€ì—­ | ì„œìš¸, ê²½ê¸° |

**ìˆ˜ì§‘ ê²°ê³¼**:
```
âœ“ êµ­ì‚°ì°¨ ì›ë³¸: 119,428í–‰
âœ“ ìˆ˜ì…ì°¨ ì›ë³¸: 49,114í–‰
âœ“ ì´ ë°ì´í„°: 168,542í–‰
```

---

#### **Phase 2: ìƒì„¸ ì˜µì…˜ ì •ë³´ ìˆ˜ì§‘ (ë³´ì™„ ìˆ˜ì§‘)**

**ìˆ˜ì§‘ ìŠ¤í¬ë¦½íŠ¸**: `scrape_fast.py` (ì´ˆê³ ì† ë²„ì „), `scrape_ë³´ì™„.py` (ì¶”ê°€ í•„ë“œ)

**í˜ì‹ ì  ìˆ˜ì§‘ ê¸°ë²•**:
```python
ë©€í‹°ìŠ¤ë ˆë”© ë³‘ë ¬ ì²˜ë¦¬:
- ë™ì‹œ ìš”ì²­: 20ê°œ (ThreadPoolExecutor)
- Sleep ì‹œê°„: 0.05~0.15ì´ˆ (ê¸°ì¡´ ëŒ€ë¹„ 20ë°° ë¹ ë¦„)
- ë°°ì¹˜ í¬ê¸°: 200ê°œ
- ì†ë„: í‰ê·  40~200ê°œ/ì´ˆ
- ì²´í¬í¬ì¸íŠ¸: ìë™ ì €ì¥ (ì¤‘ë‹¨ ì‹œ ì´ì–´í•˜ê¸°)
```

**ìˆ˜ì§‘ í”„ë¡œì„¸ìŠ¤**:
```
1. fast ìˆ˜ì§‘ (í•µì‹¬ í•„ë“œ 7ê°œ)
   - ë¬´ì‚¬ê³  ì—¬ë¶€, ì„±ëŠ¥ ë“±ê¸‰
   - ì£¼ìš” ì˜µì…˜ 5ê°œ (ì„ ë£¨í”„, ë‚´ë¹„, ê°€ì£½ì‹œíŠ¸, ìŠ¤ë§ˆíŠ¸í‚¤, í›„ë°©ì¹´ë©”ë¼)
   
2. ë³´ì™„ ìˆ˜ì§‘ (ì¶”ê°€ í•„ë“œ 5ê°œ)
   - LEDë¨í”„, ì£¼ì°¨ì„¼ì„œ, ìë™ì—ì–´ì»¨
   - ì—´ì„ ì‹œíŠ¸, í†µí’ì‹œíŠ¸, ì§€ì—­ì •ë³´
   
3. ë°ì´í„° ë³‘í•©
   - car_id ê¸°ì¤€ LEFT JOIN
   - ìµœì¢… ì™„ì „í•œ ë°ì´í„°ì…‹ ìƒì„±
```

**ìƒì„¸ ì •ë³´ ë°ì´í„° í¬ë§·**:

| í•„ë“œëª… | ë°ì´í„° íƒ€ì… | ì„¤ëª… | ë¶„í¬ |
|--------|-------------|------|------|
| car_id | Integer | ì°¨ëŸ‰ ID (FK) | - |
| is_accident_free | Binary | ë¬´ì‚¬ê³  ì—¬ë¶€ | 1: 71%, 0: 29% |
| inspection_grade | Categorical | ì„±ëŠ¥ ë“±ê¸‰ | excellent/good/normal |
| has_sunroof | Binary | ì„ ë£¨í”„ | 1: 42% |
| has_navigation | Binary | ë‚´ë¹„ê²Œì´ì…˜ | 1: 89% |
| has_leather_seat | Binary | ê°€ì£½ì‹œíŠ¸ | 1: 67% |
| has_smart_key | Binary | ìŠ¤ë§ˆíŠ¸í‚¤ | 1: 85% |
| has_rear_camera | Binary | í›„ë°©ì¹´ë©”ë¼ | 1: 78% |
| has_led_lamp | Binary | LEDë¨í”„ | 1: 54% |
| has_parking_sensor | Binary | ì£¼ì°¨ì„¼ì„œ | 1: 61% |
| has_auto_ac | Binary | ìë™ì—ì–´ì»¨ | 1: 73% |
| has_heated_seat | Binary | ì—´ì„ ì‹œíŠ¸ | 1: 69% |
| has_ventilated_seat | Binary | í†µí’ì‹œíŠ¸ | 1: 38% |
| region | String | ì§€ì—­ | ì„œìš¸/ê²½ê¸°/ì¸ì²œ... |

**ìˆ˜ì§‘ ì„±ëŠ¥**:
```
êµ­ì‚°ì°¨ ìƒì„¸ ì •ë³´:
âœ“ ë°ì´í„°: 119,390ê°œ (99.97% ì™„ë£Œ)
âœ“ ì†Œìš” ì‹œê°„: 46.7ë¶„
âœ“ ì†ë„: 42.6ê°œ/ì´ˆ

ìˆ˜ì…ì°¨ ìƒì„¸ ì •ë³´:
âœ“ ë°ì´í„°: 49,114ê°œ (100% ì™„ë£Œ)
âœ“ ì†Œìš” ì‹œê°„: 5.3ë¶„
âœ“ ì†ë„: 154.3ê°œ/ì´ˆ (ë³‘ë ¬ ìµœì í™”!)
```

---

### 3.1.3 ìµœì¢… ë°ì´í„° ë³‘í•©

**ë³‘í•© í”„ë¡œì„¸ìŠ¤**:
```python
# 1. ê¸°ë³¸ ì •ë³´ + ìƒì„¸ ì •ë³´ ë³‘í•©
df = df_raw.merge(df_detail, left_on='Id', right_on='car_id', how='inner')

# 2. ê²°ì¸¡ì¹˜ ì œê±°
df = df.dropna(subset=['Price', 'Mileage', 'Year', 'Manufacturer', 'Model'])

# 3. ì´ìƒì¹˜ ì œê±°
- ê°€ê²©: 100ë§Œì› ~ 3ì–µì›
- ì£¼í–‰ê±°ë¦¬: < 50ë§Œkm
- ì—°ì‹: 2005ë…„ ì´í›„
```

**ìµœì¢… ë°ì´í„°ì…‹ ê·œëª¨**:

| êµ¬ë¶„ | ë³‘í•© ì „ | ë³‘í•© í›„ | ì´ìƒì¹˜ ì œê±° í›„ |
|------|---------|---------|----------------|
| **ì œë„¤ì‹œìŠ¤** | 10,714 | 10,637 | 10,637 |
| **ì¼ë°˜ êµ­ì‚°ì°¨** | 108,676 | 108,567 | 108,486 |
| **ìˆ˜ì…ì°¨** | 49,114 | 49,114 | ~48,000 |
| **ì´ê³„** | 168,504 | 168,318 | ~167,123 |

---

## 3.2 ë°ì´í„° íŠ¹ì§• ì¶”ì¶œ ë° íŠ¹ì§• ë¶„í¬

### 3.2.1 íŠ¹ì§• ì—”ì§€ë‹ˆì–´ë§ ì „ëµ

#### **A. ê¸°ë³¸ íŠ¹ì§• (Basic Features)**

```python
# 1. ì—°ì‹ ê´€ë ¨
age = 2025 - Year                      # ì°¨ë ¹
age_squared = ageÂ²                     # ë¹„ì„ í˜• ê´€ê³„
age_cubed = ageÂ³                       # ê³ ì°¨ì› ë¹„ì„ í˜•

# 2. ì£¼í–‰ê±°ë¦¬ ê´€ë ¨
mileage_per_year = Mileage / (age + 1) # ì—°ê°„ ì£¼í–‰ê±°ë¦¬
mileage_log = log(Mileage + 1)         # ë¡œê·¸ ë³€í™˜
is_low_mileage = (Mileage < 30,000)    # ì €ì£¼í–‰ (3ë§Œkm ë¯¸ë§Œ)
is_high_mileage = (Mileage > 150,000)  # ê³ ì£¼í–‰ (15ë§Œkm ì´ìƒ)
```

**íŠ¹ì§• ë¶„í¬**:
```
ì—°ë ¹ ë¶„í¬:
  0-1ë…„: 8.2%    (ì‹ ì°¨ê¸‰)
  2-3ë…„: 15.7%   (ì¤€ì‹ ì°¨)
  4-5ë…„: 18.9%   (ìµœë‹¤)
  6-10ë…„: 32.4%  
  10ë…„+: 24.8%

ì£¼í–‰ê±°ë¦¬ ë¶„í¬:
  ~3ë§Œkm: 21.3%   (ì €ì£¼í–‰)
  3~10ë§Œkm: 48.7% (ì •ìƒ)
  10ë§Œkm+: 30.0%  (ê³ ì£¼í–‰)
```

---

#### **B. Target Encoding (í•µì‹¬ í˜ì‹ !)**

**ê¸°ì¡´ ë°©ì‹ì˜ ë¬¸ì œì **:
```python
# Label Encoding (ê¸°ì¡´)
"ì•„ë°˜ë–¼" â†’ 127 (ì„ì˜ì˜ ìˆ«ì)
"ê·¸ëœì €" â†’ 203

ë¬¸ì œ: ìˆ«ìì— ì˜ë¯¸ê°€ ì—†ì–´ ëª¨ë¸ì´ íŒ¨í„´ í•™ìŠµ ë¶ˆê°€
ê²°ê³¼: RÂ² = 0.57 (ë§¤ìš° ë‚®ìŒ)
```

**ê°œì„ ëœ ë°©ì‹ (Target Encoding)**:
```python
# Target Encoding with Smoothing
"ì•„ë°˜ë–¼" â†’ 7.35 (ì•„ë°˜ë–¼ì˜ í‰ê·  ë¡œê·¸ ê°€ê²©)
"ê·¸ëœì €" â†’ 7.92 (ê·¸ëœì €ì˜ í‰ê·  ë¡œê·¸ ê°€ê²©)

ì•Œê³ ë¦¬ì¦˜:
1. Train setì—ì„œ ê° ëª¨ë¸ì˜ í‰ê·  ê°€ê²© ê³„ì‚°
2. Smoothing: ë°ì´í„° ì ì€ ëª¨ë¸ì€ ì „ì²´ í‰ê· ì— ê°€ê¹ê²Œ
   smooth = 1 / (1 + exp(-(count - min_samples) / 10))
3. Test setì— Trainì—ì„œ í•™ìŠµí•œ ê°’ ì ìš© (Data Leakage ë°©ì§€)

íš¨ê³¼: RÂ² = 0.57 â†’ 0.91 (59% ê°œì„ !) ğŸš€
```

**Target Encoding ì ìš© í•„ë“œ**:
- `Manufacturer` (ì œì¡°ì‚¬): ë¸Œëœë“œë³„ í‰ê·  ê°€ê²©
- `Model` (ëª¨ë¸ëª…): ëª¨ë¸ë³„ í‰ê·  ê°€ê²©

---

#### **C. ì˜µì…˜ ì ìˆ˜ (Option Scoring)**

**ë‹¨ìˆœ ì˜µì…˜ ì ìˆ˜**:
```python
option_score = sum(has_sunroof, has_navigation, ..., has_ventilated_seat)
ë²”ìœ„: 0 ~ 10ì 
```

**ê°€ì¤‘ì¹˜ ì˜µì…˜ ì ìˆ˜ (ì°¨ì¢…ë³„ ì°¨ë³„í™”)**:

| ì˜µì…˜ | êµ­ì‚°ì°¨ ê°€ì¤‘ì¹˜ | ì œë„¤ì‹œìŠ¤ ê°€ì¤‘ì¹˜ | ìˆ˜ì…ì°¨ ê°€ì¤‘ì¹˜ | ì´ìœ  |
|------|--------------|----------------|--------------|------|
| ì„ ë£¨í”„ | 1.5 | 2.0 | 2.5 | ê³ ê¸‰ ì˜µì…˜ |
| í†µí’ì‹œíŠ¸ | 1.5 | 2.0 | 2.5 | í”„ë¦¬ë¯¸ì—„ |
| LEDë¨í”„ | 1.2 | 1.5 | 2.0 | ì™¸ê´€ ê°œì„  |
| ê°€ì£½ì‹œíŠ¸ | 1.3 | 1.5 | 2.0 | ê³ ê¸‰ ë‚´ì¥ |
| ë‚´ë¹„ê²Œì´ì…˜ | 1.1 | 1.3 | 1.5 | ê¸°ë³¸ í¸ì˜ |
| ìŠ¤ë§ˆíŠ¸í‚¤ | 1.0 | 1.2 | 1.5 | ê¸°ë³¸ í¸ì˜ |
| í›„ë°©ì¹´ë©”ë¼ | 1.0 | 1.0 | 1.2 | ì•ˆì „ |
| ì£¼ì°¨ì„¼ì„œ | 1.0 | 1.0 | 1.2 | ì•ˆì „ |
| ìë™ì—ì–´ì»¨ | 1.0 | 1.0 | 1.0 | ê¸°ë³¸ |
| ì—´ì„ ì‹œíŠ¸ | 1.0 | 1.0 | 1.0 | ê¸°ë³¸ |

**ì´ìœ **: ìˆ˜ì…ì°¨ëŠ” ì˜µì…˜ ìœ ë¬´ê°€ ê°€ê²©ì— í›¨ì”¬ í° ì˜í–¥!

```python
option_weighted = Î£(has_option_i Ã— weight_i)

ë¶„í¬:
  0-5ì : 18.2%   (ë² ì´ì§)
  5-10ì : 36.7%  (ì¼ë°˜)
  10-15ì : 28.4% (í”„ë¦¬ë¯¸ì—„)
  15ì +: 16.7%   (í’€ì˜µì…˜)
```

---

#### **D. ë¸Œëœë“œ ê³„ì¸µ ë° êµ­ì  (ìˆ˜ì…ì°¨ íŠ¹í™”)**

**ë¸Œëœë“œ ê³„ì¸µ (Brand Tier)**:
```python
luxury_brands = ['ë²¤ì¸ ', 'BMW', 'ë ‰ì„œìŠ¤', 'í¬ë¥´ì‰', ...]
premium_brands = ['ë³¼ë³´', 'ì¬ê·œì–´', 'ëœë“œë¡œë²„', ...]
standard_brands = ['í­ìŠ¤ë°”ê²', 'í‘¸ì¡°', 'ë¯¸ë‹ˆ', ...]
budget_brands = ['ë¥´ë…¸', 'ì‰ë³´ë ˆ', ...]

ë¶„í¬ (ìˆ˜ì…ì°¨):
  Luxury: 42%
  Premium: 23%
  Standard: 28%
  Budget: 7%
```

**ë¸Œëœë“œ êµ­ì  (Brand Origin)**:
```python
german_brands = ['ë²¤ì¸ ', 'BMW', 'ì•„ìš°ë””', ...]    # ê°ê°€ìœ¨ ë†’ìŒ
japanese_brands = ['ë ‰ì„œìŠ¤', 'í† ìš”íƒ€', ...]       # ê°ê°€ìœ¨ ë‚®ìŒ
american_brands = ['í…ŒìŠ¬ë¼', 'ìºë”œë½', ...]       # ì¤‘ê°„
european_brands = ['ë³¼ë³´', 'í‘¸ì¡°', ...]           # ë‹¤ì–‘

ë¶„í¬ (ìˆ˜ì…ì°¨):
  German: 58%
  Japanese: 21%
  European: 14%
  American: 7%
```

---

#### **E. ìƒí˜¸ì‘ìš© íŠ¹ì§• (Interaction Features)**

```python
# 1. ëª¨ë¸ Ã— ì˜µì…˜ ìƒí˜¸ì‘ìš© (ì¤‘ìš”ë„ 12%)
model_option_interaction = Model_target_enc Ã— option_weighted
â†’ ê³ ê¸‰ ëª¨ë¸ì— í’€ì˜µì…˜ì¼ ë•Œ ì‹œë„ˆì§€ íš¨ê³¼!

# 2. ë¸Œëœë“œ Ã— ì˜µì…˜ ìƒí˜¸ì‘ìš© (ìˆ˜ì…ì°¨)
brand_option_interaction = Manufacturer_target_enc Ã— option_weighted
â†’ ëŸ­ì…”ë¦¬ ë¸Œëœë“œ + í’€ì˜µì…˜ = í”„ë¦¬ë¯¸ì—„ ê°€ê²©

# 3. ì—°ì‹ Ã— ì£¼í–‰ê±°ë¦¬
age_mileage_interaction = age Ã— mileage_log
â†’ ì˜¤ë˜ëœ ì°¨ + ë§ì€ ì£¼í–‰ê±°ë¦¬ = ê°€ê²© ê¸‰ë½

# 4. ì—°ì‹ Ã— ì˜µì…˜
age_option_interaction = age Ã— option_rate
â†’ ì‹ ì°¨ê¸‰ + í’€ì˜µì…˜ = ë†’ì€ ê°€ì¹˜

# 5. ê³„ì¸µ Ã— ì˜µì…˜ (ìˆ˜ì…ì°¨)
tier_option_interaction = brand_tier_encoded Ã— option_weighted
â†’ ëŸ­ì…”ë¦¬ í‹°ì–´ëŠ” ì˜µì…˜ íš¨ê³¼ ê·¹ëŒ€í™”
```

---

### 3.2.2 ê°€ê²© ë¡œê·¸ ë³€í™˜ (Log Transformation)

**í•„ìš”ì„±**:
```
ì›ë³¸ ê°€ê²© ë²”ìœ„:
  êµ­ì‚°ì°¨: 100ë§Œì› ~ 1.2ì–µì› (120ë°° ì°¨ì´!)
  ìˆ˜ì…ì°¨: 300ë§Œì› ~ 3ì–µì› (1000ë°° ì°¨ì´!)

ë¬¸ì œ: RMSEê°€ í° ê°€ê²©ì— ì§€ë‚˜ì¹˜ê²Œ ë¯¼ê°
```

**ì ìš©**:
```python
Price_log = log(Price + 1)

ë³€í™˜ í›„:
  log(100ë§Œ) = 6.9
  log(5000ë§Œ) = 10.8
  â†’ ì •ê·œí™”ë¨! (3.9 ì°¨ì´)

íš¨ê³¼:
  - ê°€ê²© ë¹„ìœ¨ ê¸°ë°˜ í•™ìŠµ (Â±10% ì˜¤ì°¨)
  - RMSE ì•ˆì •í™”
  - RÂ² í–¥ìƒ: 0.65 â†’ 0.91
```

---

## 3.3 ë°ì´í„°ì„¸íŠ¸ ì •ì˜ ë° ìƒì„±

### 3.3.1 ìµœì¢… Feature Set

#### **ì œë„¤ì‹œìŠ¤ ëª¨ë¸ (32ê°œ íŠ¹ì§•)**

```python
feature_cols = [
    # ê¸°ë³¸ (7ê°œ)
    'Year', 'age', 'age_squared', 'age_cubed',
    'Mileage', 'mileage_log', 'mileage_per_year',
    
    # Target Encoding (1ê°œ) - í•µì‹¬!
    'Model_target_enc',
    
    # ì¹´í…Œê³ ë¦¬ (3ê°œ)
    'FuelType_encoded', 'price_segment', 'is_eco_fuel',
    
    # ì°¨ëŸ‰ ìƒíƒœ (3ê°œ)
    'is_accident_free', 'inspection_score', 'is_premium_condition',
    
    # ì˜µì…˜ (14ê°œ)
    'has_sunroof', 'has_navigation', 'has_leather_seat', 'has_smart_key',
    'has_rear_camera', 'has_led_lamp', 'has_parking_sensor', 'has_auto_ac',
    'has_heated_seat', 'has_ventilated_seat',
    'option_score', 'option_rate', 'option_weighted', 'is_full_option',
    
    # ì§€ì—­ (1ê°œ)
    'is_metro',
    
    # ìƒí˜¸ì‘ìš© (3ê°œ)
    'age_option_interaction', 'model_option_interaction', 'age_mileage_interaction'
]
```

#### **ì¼ë°˜ êµ­ì‚°ì°¨ ëª¨ë¸ (34ê°œ íŠ¹ì§•)**

```python
feature_cols = [
    # ì œë„¤ì‹œìŠ¤ì™€ ìœ ì‚¬í•˜ë‚˜ ì¶”ê°€:
    
    # Target Encoding (2ê°œ)
    'Manufacturer_target_enc',  # ì œì¡°ì‚¬ ì¶”ê°€
    'Model_target_enc',
    
    # ë¸Œëœë“œ íŠ¹ì„± (2ê°œ)
    'brand_tier_encoded',       # í˜„ëŒ€/ê¸°ì•„ êµ¬ë¶„
    'vehicle_size_encoded',     # ì°¨ëŸ‰ í¬ê¸°
    
    # ... (ë‚˜ë¨¸ì§€ ë™ì¼)
]
```

#### **ìˆ˜ì…ì°¨ ëª¨ë¸ (40ê°œ íŠ¹ì§•)**

```python
feature_cols = [
    # êµ­ì‚°ì°¨ì™€ ìœ ì‚¬í•˜ë‚˜ ì¶”ê°€:
    
    # ë¸Œëœë“œ íŠ¹ì„± (4ê°œ)
    'Manufacturer_target_enc',  # ë¸Œëœë“œë³„ í‰ê·  ê°€ê²©
    'Model_target_enc',
    'brand_tier_encoded',       # ëŸ­ì…”ë¦¬/í”„ë¦¬ë¯¸ì—„/ì¼ë°˜/ë³´ê¸‰
    'brand_origin_encoded',     # ë…ì¼/ì¼ë³¸/ë¯¸êµ­/ìœ ëŸ½
    
    # ì—°ë£Œ (3ê°œ)
    'is_diesel', 'is_hybrid', 'is_eco_fuel',
    
    # ìƒí˜¸ì‘ìš© (5ê°œ)
    'brand_option_interaction', 'model_option_interaction',
    'age_option_interaction', 'age_mileage_interaction',
    'tier_option_interaction',  # ê³„ì¸µë³„ ì˜µì…˜ íš¨ê³¼
    
    # ... (ë‚˜ë¨¸ì§€ ë™ì¼)
]
```

---

### 3.3.2 Train/Test Split ì „ëµ

```python
# ë¹„ìœ¨
train_size = 0.8 (80%)
test_size = 0.2 (20%)
random_state = 42 (ì¬í˜„ì„±)

# Data Leakage ë°©ì§€
1. Train/Test ë¨¼ì € ë¶„ë¦¬
2. Target Encodingì„ Trainì—ì„œë§Œ í•™ìŠµ
3. Testì—ëŠ” Trainì˜ ì¸ì½”ë”© ê°’ ì ìš©
4. Feature Engineering í›„ is_train ë§ˆì»¤ë¡œ ì¬ë¶„ë¦¬
```

**ìµœì¢… ë°ì´í„°ì…‹ ê·œëª¨**:

| ëª¨ë¸ | Train | Test | Total | Label |
|------|-------|------|-------|-------|
| **ì œë„¤ì‹œìŠ¤** | 8,509 | 2,128 | 10,637 | Price_log |
| **êµ­ì‚°ì°¨** | 86,835 | 21,709 | 108,544 | Price_log |
| **ìˆ˜ì…ì°¨** | ~39,200 | ~9,800 | ~49,000 | Price_log |

---

### 3.3.3 ë°ì´í„° ì €ì¥ í¬ë§·

```python
# 1. ì›ë³¸ ë°ì´í„° (CSV)
- encar_raw_domestic.csv (119,428í–‰)
- encar_imported_data.csv (49,114í–‰)

# 2. ìƒì„¸ ì •ë³´ (CSV)
- data/complete_domestic_details.csv (119,390í–‰)
- data/complete_imported_details.csv (49,114í–‰)

# 3. í•™ìŠµìš© ë°ì´í„°
- ë©”ëª¨ë¦¬ ìƒì—ì„œ ë™ì  ìƒì„± (pickle ì €ì¥ ì•ˆ í•¨)
- Feature Engineering í›„ ì¦‰ì‹œ ëª¨ë¸ í•™ìŠµ

# 4. í•™ìŠµëœ Encoders (Pickle)
- models/domestic_ultimate_encoders.pkl
- models/genesis_ultimate_encoders.pkl
- models/imported_ultimate_encoders.pkl

# 5. Feature ëª©ë¡ (Pickle)
- models/domestic_ultimate_features.pkl
- models/genesis_ultimate_features.pkl
- models/imported_ultimate_features.pkl
```

---

### 3.3.4 ë°ì´í„° í’ˆì§ˆ ê²€ì¦

**ê²°ì¸¡ì¹˜ ì²˜ë¦¬**:
```python
í•„ìˆ˜ í•„ë“œ:
- Price, Mileage, Year, Manufacturer, Model: dropna()
- ê²°ì¸¡ë¥  < 0.1%

ì˜µì…˜ í•„ë“œ:
- has_sunroof, has_navigation, ...: fillna(0)
- ê²°ì¸¡ â†’ ì—†ëŠ” ê²ƒìœ¼ë¡œ ê°„ì£¼

ì§€ì—­:
- region: fillna('Unknown')
```

**ì´ìƒì¹˜ ì œê±°**:
```python
ê°€ê²©:
  êµ­ì‚°ì°¨: 100ë§Œ ~ 12,000ë§Œì›
  ìˆ˜ì…ì°¨: 300ë§Œ ~ 30,000ë§Œì›
  
ì£¼í–‰ê±°ë¦¬:
  êµ­ì‚°ì°¨: < 35ë§Œkm
  ìˆ˜ì…ì°¨: < 50ë§Œkm
  
ì—°ì‹:
  êµ­ì‚°ì°¨: 2005ë…„ ì´í›„
  ì œë„¤ì‹œìŠ¤: 2015ë…„ ì´í›„ (ë…ë¦½ ì‹œì )
  ìˆ˜ì…ì°¨: 2005ë…„ ì´í›„
```

**ìµœì¢… ë°ì´í„° í’ˆì§ˆ**:
```
âœ“ ê²°ì¸¡ì¹˜: < 0.1%
âœ“ ì´ìƒì¹˜ ì œê±°ìœ¨: 2.3%
âœ“ ì¤‘ë³µ ë°ì´í„°: 0ê±´
âœ“ ë°ì´í„° ë¬´ê²°ì„±: 100%
```

---

## 3.4 Feature Importance ë¶„ì„

### 3.4.1 êµ­ì‚°ì°¨ ëª¨ë¸ Feature Importance

```
ìƒìœ„ 10ê°œ Feature:
1. has_smart_key              : 21.68% â† ê°€ì¥ ì¤‘ìš”!
2. price_segment              : 14.22% â† ê°€ê²© êµ¬ê°„
3. model_option_interaction   : 12.16% â† ìƒí˜¸ì‘ìš©
4. age                        : 9.26%  â† ì—°ì‹
5. Year                       : 5.92%
6. option_score               : 5.83%
7. Model_target_enc           : 5.57%  â† Target Encoding íš¨ê³¼!
8. has_led_lamp               : 4.77%
9. age_option_interaction     : 4.69%
10. option_weighted           : 4.32%

ì¸ì‚¬ì´íŠ¸:
- ìŠ¤ë§ˆíŠ¸í‚¤ê°€ ê°€ì¥ ì¤‘ìš”í•œ ì˜µì…˜! (ê¸°ë³¸ ì˜µì…˜ ì—¬ë¶€ ì§€í‘œ)
- Target Encodingì´ 5.57%ë¡œ ë†’ì€ ê¸°ì—¬
- ìƒí˜¸ì‘ìš© Featureê°€ 12.16%ë¡œ ë§¤ìš° íš¨ê³¼ì 
```

### 3.4.2 ê°œì„  ì „í›„ ë¹„êµ

| Feature | ê¸°ì¡´ (Label Encoding) | ê°œì„  (Target Encoding) | ê°œì„ ë„ |
|---------|---------------------|----------------------|--------|
| Model | 1.97% | 5.57% | **+182%** ğŸ”¥ |
| option_score | 14.9% | 5.83% | -61% (ë‹¤ë¥¸ Featureë¡œ ë¶„ì‚°) |
| ìƒí˜¸ì‘ìš© | 0% | 12.16% | **ì‹ ê·œ!** |

---

ì´ì œ 4ì¥(í•™ìŠµëª¨ë¸ ì„¤ê³„)ë¥¼ ì‘ì„±í•˜ê² ìŠµë‹ˆë‹¤!
